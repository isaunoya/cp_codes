## A. B. C. D.

略。

## E.

### 题意

给定一张含 $n$ 个玩家 1 节点 $m$ 个玩家 2 节点的有向二分图，两个玩家在上面进行博弈。初始有一个棋 子被随机放在一个节点上，接下来，若棋子落入到玩家 1 的节点上时，玩家 1 移动该棋子沿节点的一条 出边至下一个玩家 2 节点上，若棋子落入到玩家 2 的节点上时，玩家 2 同理移动棋子。若棋子落入到一 个没有出边的节点上时，博弈停止，否则博弈继续。玩家 1 目标是让每个节点均被棋子经过无数次，玩家 2 则相反，判断玩家 1 是否必胜。

---

### sol

问题等价于，找到一个点，使得 Alice 不能无限次经过，则 Bob 胜，否则 Alice 胜。称这样的点为防御点。

考虑枚举防御点，先判断一下可达性，如果有的点到不了防御点，那么 Alice 肯定必败。

防御点是一个终态点，如果 Alice 不能到达防御点，那么 Bob 不能去指向防御点的点，以此类推。

初始时，将防御点放入队列，对于二分图上的点，每个点计算一个 dp 值，如果防御点位于左侧，Alice 到这个点就视为获胜，如果位于右侧，就视为失败。

- 如果一个点的下游都是对方的必胜点（反图的上游）都是对方的必胜点，那么这个点是必败的。
- 如果一个点的下游存在一个对方的必败点，那么这个点肯定能胜。

一个点确定的必胜必败，就放入队列，直到更新完所有点。

跑完这一轮之后将 Alice 必败的起点，和 Bob 必胜的起点全部排除。

有一些点是未被更新的，也就是拓扑排序里的环。

这些点的特性是

- 不存在下游是对方的必败点
- 存在一部分下游点是对方的必胜点
- 另一部分下游点是状态未确定的点

如果 Alice 和 Bob 在这些点上玩的话都会走向状态未确定的点，使 Alice 永远走不到防御点。

所以状态未确定的点也需要被排除。

枚举完一个点就要过滤到一些点。

枚举完所有点后没有被过滤掉的点就是 Alice 的必胜起点，若不存在则 Bob 必胜。

## F.

咕咕。

## G.

对于第一问

$dp_{i, j}$ 表示 $i$ 子树内有 $j$ 个未匹配的方案数。

转移是考虑树上背包，对子树昨晚树上背包后，再考虑 u 这个点的决策，要么是选一个之前未匹配的点匹配，要么是新增一个未匹配的点。

这是容易的。

对于第二问，长度为 4 的祖先链（都在通往同一条祖先的路径上）所以可以考虑把 0 和 4 都维护上，但是 dp 的时候并不指定这四个点的连接方式，只统计四元组的总方案数。

- 这相当于从树上扣掉四个点，四个点在一个祖先上时，剩下的点构成合法方案的方案数。

感觉这个转化还是比较合理的，1111。

转移的时候稍微注意一下就可以了。



